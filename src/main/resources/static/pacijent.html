<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8">
    <!-- This file has been downloaded from Bootsnipp.com. Enjoy! -->
    <title>Patient</title>
    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="./js/lib/jquery-3.3.1.min.js" type="text/javascript"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="./js/pacijent.js" type="text/javascript"></script>

	<!-- Website CSS style -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="pacijent.css">
	
	<!-- Website Font style -->
    <script src="https://kit.fontawesome.com/a065fea601.js" crossorigin="anonymous"></script>
	<!-- Google Fonts -->
	<link href='https://fonts.googleapis.com/css?family=Passion+One' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Oxygen' rel='stylesheet' type='text/css'>
	<script type="text/javascript">

	$(document).ready(()=>{
		document.getElementById ("bPretraga").addEventListener ("click", searchUser, false);
	})

	function home(){
		$('#patientsTable').attr('hidden', true);
		$('#patient').attr('hidden', true);
		$('#sSearch').attr('hidden', false);
		document.getElementById("title").innerHTML = "";
	
		
	}
	
	function searchKorisnikF(type, value){

		if (value.length === 0){
			alert("Niste uneli kriterijum pretrage!");
			return;
		}
		
		$.ajax({
			url: "/pacijent/searchK/" + value + ":" + type,
			type: "GET",
			success: function(korisnici){
				$("#patientsTable tr").remove();
				if(korisnici.length > 0){
					$('#patientsTable').attr('hidden', false);
					$('#lFilter').attr('hidden', false);
					$('#fSearch').attr('hidden', false);
					$('#bFilter').attr('hidden', false);
				}else{
					alert("Pretraga nije pronasla pacijenta sa zadatim parametrima");
					$('#patientsTable').attr('hidden', true);
					$('#lFilter').attr('hidden', true);
					$('#fSearch').attr('hidden', true);
					$('#bFilter').attr('hidden', true);
				}
				for (i = 0; i < korisnici.length; i++){
					
					let tr = $('<tr></tr>');
					let tdIme = $('<td>' + korisnici[i].ime + '</td>');
					let tdPrezime = $('<td>' + korisnici[i].prezime + '</td>');
					let tdID = $('<td>' + korisnici[i].id + '</td>');
					let tdLin = $('<td><a href = \"karton.html\">Karton pacijenta</a></td>');
					tr.append(tdIme).append(tdPrezime).append(tdID).append(tdLin);
					$('#patientsTable tbody').append(tr);
				}
			},
			error: function(e){
				console.log(e)
				alert("error");
			}
		})
	}
	
	function searchPacijentF(type, value){
		
	}
	
	function searchUser(){
		let type = $('#sSearch').val();
		let value = $('#tfSearch').val();
		searchKorisnikF(type, value);
		searchPacijentF(type, value);
		
	}


	</script>
<body>
<nav class="navbar navbar-inverse">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <a class="navbar-brand">Clinical centre</a>
	    </div>
	    <ul class="nav navbar-nav" id = "clickList">
	      <li><a id = "aHome" onclick = "home()" href = "#">New Seach</a></li>
	    </ul>
	    <ul class="nav navbar-nav navbar-right">
	      <li><a href="#"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
	    </ul>
	  </div>
	</nav>
	
	<h1 id="title"></h1>
	
	<label id = "lSearch">Select search criteria</label>
	<select id = "sSearch" align = "center">
	<option id = "sIme" value = "Ime">Name</option>
	<option id = "sPrezime" value = "Prezime">Surname</option>
	<option id = "sBroj" value = "JedinstveniBroj">ID number</option>
	</select>
	<input type = "text" id = "tfSearch">
	<input type = "submit" value = "Pretraga" id = "bPretraga">
	
	<table class="table" id="patientsTable" hidden="true">
	  <thead>
	    <tr>
	      <th scope="col">Name</th>
	      <th scope="col">Surname</th>
	      <th scope="col">ID</th>
	      <th scope="col">More</th>
	    </tr>
	  </thead>
	  <tbody>
	    
	  </tbody>
	</table>
	
	<label id = "lFilter" hidden = "true">Select Filter Criteria</label>
	<select id = "fSearch" align = "center" hidden = "true">
	<option id = "fIme" value = "Ime">Name</option>
	<option id = "fPrezime" value = "Prezime">Surname</option>
	<option id = "fBroj" value = "JedinstveniBroj">ID number</option>
	</select>
	<button id = "bFilter" hidden = "true">Filter</button>
</body>
</html>